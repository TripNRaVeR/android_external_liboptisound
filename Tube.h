/*
 * Copyright (C) 2017 TripNDroid Mobile Engineering
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#ifndef __TUBE_H__
#define __TUBE_H__

#include "wdfcircuits_triode.h"

#define DANGER 1000.f

typedef struct str_tubeFilter {
    Triode v;
    TubeStageCircuit ckt;
    Real e;
    Real ci;
    Real ck;
    Real co;
    Real ro;
    Real rp;
    Real rg;
    Real ri;
	Real rk;
    float overdrived1Gain;
    float overdrived2Gain;
	float mastergain;
    float   fConst0;
    float   fConst1;
    float   fConst2;
    float   fConst3;
    float   fRec0[4];
    float   fRec1[4];
    float   fRec2[4];
    float   fRec3[4];
    float   fRec4[4];
    float   fRec5[4];
    float   fRec6[4];
    float   fRec7[4];
    float   fRec8[4];
    float   fRec9[4];
    float   fRec10[4];
    float   fRec11[4];
    float   fRec12[4];
    float   fRec13[4];
    float   fConst4;
    float   fConst5;
    float   fRec14[4];
    float   fConst6;
    float   fRec15[4];
    float   fRec16[4];
    float   fRec17[4];
    float   fRec18[4];
    float   fRec19[4];
    float   fRec20[4];
    float   fRec21[4];
    float   fRec22[4];
    float   fRec23[4];
    float   fRec24[4];
    float toneStack0;
    float toneStack1;
    float toneStack2;
    float toneStack3;
    float toneStack4;
    float toneStack5;
    float toneStack6;
    float toneStack7;
    float toneStack8;
    float toneStack9;
    float toneStack10;
    float toneStack11;
    float toneStack12;
    float toneStack13;
    float toneStack14;
    float toneStack15;
    float toneStack16;
    float toneStack17;
    float toneStack18;
    float toneStack19;
    float toneStack20;
    float toneStack21;
    float toneStack22;
    float toneStack23;
    float toneStack24;
    float toneStack25;
    float toneStack26;
    float toneStack27;
    float toneStack28;
    float toneStack29;
    float toneStack30;
    int toneStack31;
    float toneStack32;
    float toneStack33;
    float toneStack34;
    float toneStack35;
    float toneStack36;
    float toneStack37;
    float toneStack38;
    float toneStack39;
    float toneStack40;
    float toneStack41;
    float toneStack42;
    float toneStack43;
    float toneStack44;
    float toneStack45;
    float toneStack46;
    float toneStack47;
    float toneStack48;
    float toneStack49;
    float toneStack50;
    float toneStack51;
    float toneStack52;
    float toneStack53;
    float toneStack54;
    float toneStack55;
    float toneStack56;
    float toneStack57;
    float toneStack58;
    float toneStack59;
    float toneStack60;
    float toneStack61;
    float toneStack62;
    float toneStack63;
    float toneStack64;
    float toneStack65;
    float toneStack66;
    float toneStack67;
    float toneStack68;
    float toneStack69;
    float toneStack70;
    float toneStack71;
    float toneStack72;
    float toneStack73;
    float toneStack74;
    float toneStack75;
    float toneStack76;
    float toneStack77;
    float toneStack78;
    float toneStack79;
    float toneStack80;
    float toneStack81;
    float toneStack82;
    float toneStack83;
    float toneStack84;
    float toneStack85;
    float toneStack86;
    float toneStack87;
    float toneStack88;
    float toneStack89;
    float toneStack90;
    float toneStack91;
    float toneStack92;
    float toneStack93;
    float toneStack94;
    float toneStack95;
    float toneStack96;
    float toneStack97;
    float toneStack98;
    float toneStack99;
    float toneStack100;
    float toneStack101;
    float toneStack102;
    float toneStack103;
    float toneStack104;
    float toneStack105;
    float toneStack106;
    float toneStack107;
    float toneStack108;
    float toneStack109;
    float toneStack110;
    float toneStack111;
    float toneStack112;
    float toneStack113;
    float toneStack114;
    float toneStack115;
    float toneStack116;
    float toneStack117;
    float toneStack118;
    float toneStack119;
    float toneStack120;
    float toneStack121;
    float toneStack122;
    float toneStack123;
    float toneStack124;
    float toneStack125;
    float toneStack126;
    float toneStack127;
    float toneStack128;
    float toneStack129;
    float toneStack130;
    float toneStack131;
    float toneStack132;
    float toneStack133;
    float toneStack134;
    float toneStack135;
    float toneStack136;
    float toneStack137;
    float toneStack138;
    float toneStack139;
    float toneStack140;
    float toneStack141;
    float toneStack142;
    float toneStack143;
    float toneStack144;
    float toneStack145;
    float toneStack146;
    float toneStack147;
    float toneStack148;
    float toneStack149;
    float toneStack150;
    float toneStack151;
    float toneStack152;
    float toneStack153;
    float toneStack154;
    float toneStack155;
    float toneStack156;
    float toneStack157;
    float toneStack158;
    float toneStack159;
    float toneStack160;
    float toneStack161;
    float toneStack162;
    float toneStack163;
    float toneStack164;
    float toneStack165;
    float toneStack166;
    float toneStack167;
    float toneStack168;
    float toneStack169;
    float toneStack170;
    float toneStack171;
    float toneStack172;
    float toneStack173;
    float toneStack174;
    float toneStack175;
    float toneStack176;
    float toneStack177;
    float toneStack178;
    float toneStack179;
    float toneStack180;
    float toneStack181;
    float toneStack182;
    float toneStack183;
    float toneStack184;
    float toneStack185;
    float toneStack186;
    float toneStack187;
    float toneStack188;
    float toneStack189;
    float toneStack190;
    float toneStack191;
    float toneStack192;
    float toneStack193;
    float toneStack194;
    float toneStack195;
    float toneStack196;
    float toneStack197;
    float toneStack198;
    float toneStack199;
    float toneStack200;
    float toneStack201;
    float toneStack202;
    float toneStack203;
    float toneStack204;
    float toneStack205;
    float toneStack206;
    float toneStack207;
    float toneStack208;
    float toneStack209;
    float toneStack210;
    float toneStack211;
    float toneStack212;
    float toneStack213;
    float toneStack214;
    float toneStack215;
    float toneStack216;
    float toneStack217;
    float toneStack218;
    float toneStack219;
    float toneStack220;
    float toneStack221;
    float toneStack222;
    float toneStack223;
    float toneStack224;
    float toneStack225;
    float toneStack226;
    float toneStack227;
    float toneStack228;
    float toneStack229;
    float toneStack230;
    float toneStack231;
    float toneStack232;
    float toneStack233;
    float toneStack234;
    float toneStack235;
    float toneStack236;
    float toneStack237;
    float toneStack238;
    float toneStack239;
    float toneStack240;
    float toneStack241;
    float toneStack242;
    float toneStack243;
    float toneStack244;
    float toneStack245;
    float toneStack246;
    float toneStack247;
    float toneStack248;
    float toneStack249;
    float toneStack250;
    float toneStack251;
    float toneStack252;
    float toneStack253;
    float toneStack254;
    float toneStack255;
    float toneStack256;
    float toneStack257;
    float toneStack258;
    float toneStack259;
    float toneStack260;
    float toneStack261;
    float toneStack262;
    float toneStack263;
    float toneStack264;
    float toneStack265;
    float toneStack266;
    float toneStack267;
    float toneStack268;
    float toneStack269;
    float toneStack270;
    float toneStack271;
    float toneStack272;
    float toneStack273;
    float toneStack274;
    float toneStack275;
    float toneStack276;
    float toneStack277;
    float toneStack278;
    float toneStack279;
    float toneStack280;
    float toneStack281;
    float toneStack282;
    float toneStack283;
    float toneStack284;
    float toneStack285;
    float toneStack286;
    float toneStack287;
    float toneStack288;
    float toneStack289;
    float toneStack290;
    float toneStack291;
    float toneStack292;
    float toneStack293;
    float toneStack294;
    float toneStack295;
    float toneStack296;
    float toneStack297;
    float toneStack298;
    float toneStack299;
    float toneStack300;
    float toneStack301;
    float toneStack302;
    float toneStack303;
    float toneStack304;
    float toneStack305;
    float toneStack306;
    float toneStack307;
    float toneStack308;
    float toneStack309;
    float toneStack310;
    float toneStack311;
    float toneStack312;
    float toneStack313;
    float toneStack314;
    float toneStack315;
    float toneStack316;
    float toneStack317;
    float toneStack318;
    float toneStack319;
    float toneStack320;
    float toneStack321;
    float toneStack322;
    float toneStack323;
    float toneStack324;
    float toneStack325;
    float toneStack326;
    float toneStack327;
    float toneStack328;
    float toneStack329;
    float toneStack330;
    float toneStack331;
    float toneStack332;
    float toneStack333;
    float toneStack334;
    float toneStack335;
    float toneStack336;
    float toneStack337;
    float toneStack338;
    float toneStack339;
    float toneStack340;
    float toneStack341;
    float toneStack342;
    float toneStack343;
    float toneStack344;
    float toneStack345;
    float toneStack346;
    float toneStack347;
    float toneStack348;
    float toneStack349;
    float toneStack350;
    float toneStack351;
    float toneStack352;
    float toneStack353;
    float toneStack354;
    float toneStack355;
    float toneStack356;
    float toneStack357;
    float toneStack358;
    float toneStack359;
    float toneStack360;
    float toneStack361;
    float toneStack362;
    float toneStack363;
    float toneStack364;
    float toneStack365;
    float toneStack366;
    float toneStack367;
    float toneStack368;
    float toneStack369;
    float toneStack370;
    float toneStack371;
    float toneStack372;
    float toneStack373;
    float toneStack374;
    float toneStack375;
    float toneStack376;
    float toneStack377;
    float toneStack378;
    float toneStack379;
    float toneStack380;
    float toneStack381;
    float toneStack382;
    float toneStack383;
    float toneStack384;
    float toneStack385;
    float toneStack386;
    float toneStack387;
    float toneStack388;
    float toneStack389;
    float toneStack390;
    float toneStack391;
    float toneStack392;
    float toneStack393;
    float toneStack394;
    float toneStack395;
    float toneStack396;
    float toneStack397;
    float toneStack398;
    float toneStack399;
    float toneStack400;
    float toneStack401;
    float toneStack402;
    float toneStack403;
    float toneStack404;
    float toneStack405;
    float toneStack406;
    float toneStack407;
    float toneStack408;
    float toneStack409;
    float toneStack410;
    float toneStack411;
    float toneStack412;
    float toneStack413;
    float toneStack414;
    float toneStack415;
    float toneStack416;
    float toneStack417;
    float toneStack418;
    float toneStack419;
    float toneStack420;
    float toneStack421;
    float toneStack422;
    float toneStack423;
    float toneStack424;
    float toneStack425;
    float toneStack426;
    float toneStack427;
    float toneStack428;
    float toneStack429;
    float toneStack430;
    float toneStack431;
    float toneStack432;
    float toneStack433;
    float toneStack434;
    float toneStack435;
    float toneStack436;
    float toneStack437;
    float toneStack438;
    float toneStack439;
    float toneStack440;
    float toneStack441;
    float toneStack442;
    float toneStack443;
    float toneStack444;
    float toneStack445;
    float toneStack446;
    float toneStack447;
    float toneStack448;
    float toneStack449;
    float toneStack450;
    float toneStack451;
    float toneStack452;
    float toneStack453;
    float toneStack454;
    float toneStack455;
    float toneStack456;
    float toneStack457;
    float toneStack458;
    float toneStack459;
    float toneStack460;
    float toneStack461;
    float toneStack462;
    float toneStack463;
    float toneStack464;
    float toneStack465;
    float toneStack466;
    float toneStack467;
    float toneStack468;
    float toneStack469;
    float toneStack470;
    float toneStack471;
    float toneStack472;
    float toneStack473;
    float toneStack474;
    float toneStack475;
    float toneStack476;
    float toneStack477;
    float toneStack478;
    float toneStack479;
    float toneStack480;
    float toneStack481;
    float toneStack482;
    float toneStack483;
    float toneStack484;
    float toneStack485;
    float toneStack486;
    float toneStack487;
    float toneStack488;
    float toneStack489;
    float toneStack490;
    float toneStack491;
    float toneStack492;
    float toneStack493;
    float toneStack494;
    float toneStack495;
    float toneStack496;
    float toneStack497;
    float toneStack498;
    float toneStack499;
    float toneStack500;
    float toneStack501;
    float toneStack502;
    float toneStack503;
    float toneStack504;
    float toneStack505;
    float toneStack506;
    float toneStack507;
    float toneStack508;
    float toneStack509;
    float toneStack510;
    float toneStack511;
    float toneStack512;
    float toneStack513;
    float toneStack514;
    float toneStack515;
    float toneStack516;
    float toneStack517;
    float toneStack518;
    float toneStack519;
    float toneStack520;
    float toneStack521;
    float toneStack522;
    float toneStack523;
    float toneStack524;
    float toneStack525;
    float toneStack526;
    float toneStack527;
    float toneStack528;
    float toneStack529;
    float toneStack530;
    float toneStack531;
    float toneStack532;
    float toneStack533;
    float toneStack534;
    float toneStack535;
    float toneStack536;
    float toneStack537;
    float toneStack538;
    float toneStack539;
    float toneStack540;
    float toneStack541;
    float toneStack542;
    float toneStack543;
    float toneStack544;
    float toneStack545;
    float toneStack546;
    float toneStack547;
    float toneStack548;
    float toneStack549;
    float toneStack550;
    float toneStack551;
    float toneStack552;
    float toneStack553;
    float toneStack554;
    float toneStack555;
    float toneStack556;
    float toneStack557;
    float toneStack558;
    float toneStack559;
    float toneStack560;
    float toneStack561;
    float toneStack562;
    float toneStack563;
    float toneStack564;
    float toneStack565;
    float toneStack566;
    float toneStack567;
    float toneStack568;
    float toneStack569;
    float toneStack570;
    float toneStack571;
    float toneStack572;
    float toneStack573;
    float toneStack574;
    float toneStack575;
    float toneStack576;
    float toneStack577;
    float toneStack578;
    float toneStack579;
    float toneStack580;
    float toneStack581;
    float toneStack582;
    float toneStack583;
    float toneStack584;
    float toneStack585;
    float toneStack586;
    float toneStack587;
    float toneStack588;
    float toneStack589;
    float toneStack590;
    float toneStack591;
    float toneStack592;
    float toneStack593;
    float toneStack594;
    float toneStack595;
    float toneStack596;
    float toneStack597;
    float toneStack598;
    float toneStack599;
    float toneStack600;
    float toneStack601;
    float toneStack602;
    float toneStack603;
    float toneStack604;
    float toneStack605;
    float toneStack606;
    float toneStack607;
    float toneStack608;
    float toneStack609;
    float toneStack610;
    float toneStack611;
    float toneStack612;
    float toneStack613;
    float toneStack614;
    float toneStack615;
    float toneStack616;
    float toneStack617;
    float toneStack618;
    float toneStack619;
    float toneStack620;
    float toneStack621;
    float toneStack622;
    float toneStack623;
    float toneStack624;
    float toneStack625;
    float toneStack626;
    float toneStack627;
    float toneStack628;
    float toneStack629;
    float toneStack630;
    float toneStack631;
    float toneStack632;
    float toneStack633;
    float toneStack634;
    float toneStack635;
    float toneStack636;
    float toneStack637;
    float toneStack638;
    float toneStack639;
    float toneStack640;
    float toneStack641;
    float toneStack642;
    float toneStack643;
    float toneStack644;
    float toneStack645;
    float toneStack646;
    float toneStack647;
    float toneStack648;
    float toneStack649;
    float toneStack650;
    float toneStack651;
    float toneStack652;
    float toneStack653;
    float toneStack654;
    float toneStack655;
    float toneStack656;
    float toneStack657;
    float toneStack658;
    float toneStack659;
    float toneStack660;
    float toneStack661;
    float toneStack662;
    float toneStack663;
    float toneStack664;
} tubeFilter;

int InitTube(tubeFilter *tubefilter, double *circuitparameters, double samplerate, float tubedrive, float bass, float middle, float treble, float tonestack, float mastergain, int insane);
void processTube(tubeFilter *tubefilter, float* inputs, float* outputs, unsigned frames);

#endif
